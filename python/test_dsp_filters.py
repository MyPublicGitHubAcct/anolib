from algo_dsp_filters import DcBlocker
import util_signals as us

#####################################################
# Signals
#####################################################
imp = us.impls()


#####################################################
# Expectations
#####################################################
test_dc_blocker_out_expected_output = [0.0, 1.0, -0.0050000000000000044, -0.004975000000000005, -0.004950125000000005, -0.004925374375000005, -0.004900747503125005, -0.0048762437656093794, -0.004851862546781332, -0.004827603234047425, -0.004803465217877188, -0.0047794478917878025, -0.0047555506523288636, -0.0047317728990672195, -0.004708114034571884, -0.0046845734643990245, -0.0046611505970770295, -0.004637844844091644, -0.004614655619871186, -0.00459158234177183, -0.004568624430062971, -0.004545781307912656, -0.004523052401373092, -0.004500437139366227, -0.004477934953669396, -0.004455545278901049, -0.004433267552506543, -0.0044111012147440105, -0.00438904570867029, -0.004367100480126939, -0.004345264977726304, -0.004323538652837673, -0.004301920959573485, -0.004280411354775617, -0.004259009298001739, -0.00423771425151173, -0.004216525680254171, -0.0041954430518529005, -0.004174465836593636, -0.004153593507410668, -0.004132825539873614, -0.004112161412174247, -0.004091600605113375, -0.004071142602087808, -0.004050786889077369, -0.004030532954631982, -0.004010380289858822, -0.003990328388409528, -0.00397037674646748, -0.003950524862735142, -0.0039307722384214665, -0.003911118377229359, -0.003891562785343212, -0.0038721049714164958, -0.003852744446559413, -0.003833480724326616, -0.0038143133207049827, -0.003795241754101458, -0.0037762655453309505, -0.0037573842176042956, -0.003738597296516274, -0.0037199043100336927, -0.0037013047884835244, -0.0036827982645411066, -0.003664384273218401, -0.0036460623518523093, -0.003627832040093048, -0.0036096928798925827, -0.0035916444154931197, -0.003573686193415654, -0.003555817762448576, -0.0035380386736363328, -0.003520348480268151, -0.0035027467378668103, -0.0034852330041774764, -0.003467806839156589, -0.0034504678049608064, -0.0034332154659360023, -0.0034160493886063225, -0.003398969141663291, -0.0033819742959549743, -0.0033650644244751994, -0.0033482391023528235, -0.0033314979068410594, -0.003314840417306854, -0.0032982662152203196, -0.0032817748841442182, -0.003265366009723497, -0.0032490391796748796, -0.003232793983776505, -0.0032166300138576224, -0.003200546863788334, -0.0031845441294693923, -0.003168621408822045, -0.003152778301777935, -0.0031370144102690453, -0.0031213293382177, -0.0031057226915266116, -0.0030901940780689785, -0.0030747431076786334, -0.00305936939214024, -0.0030440725451795388, -0.003028852182453641, -0.0030137079215413727, -0.0029986393819336657, -0.0029836461850239974, -0.0029687279540988776, -0.002953884314328383, -0.0029391148927567414, -0.0029244193182929577, -0.002909797221701493, -0.0028952482355929857, -0.0028807719944150207, -0.0028663681344429457, -0.002852036293770731, -0.002837776112301877, -0.0028235872317403676, -0.0028094692955816657, -0.002795421949103757, -0.0027814448393582384, -0.002767537615161447, -0.0027536999270856397, -0.0027399314274502116, -0.0027262317703129605, -0.0027126006114613957, -0.002699037608404089, -0.0026855424203620685, -0.002672114708260258, -0.0026587541347189566, -0.0026454603640453617, -0.0026322330622251346, -0.002619071896914009, -0.002605976537429439, -0.0025929466547422917, -0.00257998192146858, -0.0025670820118612373, -0.0025542466018019312, -0.0025414753687929216, -0.002528767991948957, -0.0025161241519892122, -0.0025035435312292663, -0.00249102581357312, -0.0024785706845052544, -0.002466177831082728, -0.0024538469419273143, -0.0024415777072176775, -0.0024293698186815893, -0.0024172229695881816, -0.002405136854740241, -0.0023931111704665396, -0.002381145614614207, -0.002369239886541136, -0.00235739368710843, -0.002345606718672888, -0.0023338786850795237, -0.002322209291654126, -0.0023105982451958555, -0.0022990452539698764, -0.002287550027700027, -0.0022761122775615266, -0.0022647317161737187, -0.00225340805759285, -0.002242141017304886, -0.0022309303122183613, -0.0022197756606572696, -0.0022086767823539834, -0.0021976333984422133, -0.002186645231450002, -0.002175712005292752, -0.0021648334452662884, -0.002154009278039957, -0.0021432392316497574, -0.0021325230354915085, -0.002121860420314051, -0.002111251118212481, -0.0021006948626214185, -0.002090191388308311, -0.0020797404313667696, -0.0020693417292099356, -0.0020589950205638858, -0.0020487000454610664, -0.002038456545233761, -0.002028264262507592, -0.002018122941195054, -0.0020080323264890787, -0.001997992164856633, -0.00198800220403235, -0.0019780621930121883, -0.0019681718820471275, -0.0019583310226368917, -0.0019485393675237072, -0.0019387966706860887, -0.0019291026873326583, -0.0019194571738959949, -0.0019098598880265148, -0.0019003105885863822, -0.0018908090356434502, -0.001881354990465233, -0.0018719482155129068, -0.0018625884744353422, -0.0018532755320631656, -0.0018440091544028498, -0.0018347891086308355, -0.0018256151630876814, -0.001816487087272243, -0.0018074046518358816, -0.0017983676285767021, -0.0017893757904338186, -0.0017804289114816494, -0.0017715267669242412, -0.00176266913308962, -0.0017538557874241718, -0.001745086508487051, -0.0017363610759446157, -0.0017276792705648925, -0.001719040874212068, -0.0017104456698410076, -0.0017018934414918026, -0.0016933839742843437, -0.0016849170544129218, -0.0016764924691408572, -0.0016681100067951528, -0.001659769456761177, -0.001651470609477371, -0.0016432132564299842, -0.0016349971901478341, -0.001626822204197095, -0.0016186880931761095, -0.0016105946527102289, -0.0016025416794466778, -0.0015945289710494444, -0.0015865563261941971, -0.001578623544563226, -0.0015707304268404098, -0.0015628767747062078, -0.0015550623908326766, -0.0015472870788785132, -0.0015395506434841206, -0.0015318528902667, -0.0015241936258153664, -0.0015165726576862896, -0.0015089897943978581, -0.0015014448454258689, -0.0014939376211987395, -0.0014864679330927456, -0.001479035593427282, -0.0014716404154601456, -0.001464282213382845, -0.0014569608023159307, -0.001449675998304351, -0.0014424276183128291, -0.001435215480221265, -0.0014280394028201586, -0.0014208992058060577, -0.0014137947097770274, -0.0014067257362281422, -0.0013996921075470014, -0.0013926936470092664, -0.0013857301787742202, -0.001378801527880349, -0.0013719075202409472, -0.0013650479826397425, -0.0013582227427265438, -0.001351431629012911, -0.0013446744708678464, -0.0013379510985135072, -0.0013312613430209396, -0.0013246050363058348, -0.0013179820111243056, -0.001311392101068684, -0.0013048351405633405, -0.001298310964860524, -0.0012918194100362214, -0.0012853603129860402, -0.00127893351142111, -0.0012725388438640044, -0.0012661761496446844, -0.001259845268896461, -0.0012535460425519786, -0.0012472783123392186, -0.0012410419207775226, -0.001234836711173635, -0.0012286625276177667, -0.0012225192149796778, -0.0012164066189047794, -0.0012103245858102554, -0.0012042729628812042, -0.0011982515980667981, -0.001192260340076464, -0.0011862990383760816, -0.0011803675431842013, -0.0011744657054682803, -0.0011685933769409389, -0.0011627504100562341, -0.001156936658005953, -0.0011511519747159232, -0.0011453962148423435, -0.0011396692337681319, -0.0011339708875992911, -0.0011283010331612946, -0.001122659527995488, -0.0011170462303555107, -0.001111460999203733, -0.0011059036942077144, -0.0011003741757366757, -0.0010948723048579924, -0.0010893979433337024, -0.0010839509536170338, -0.0010785311988489486, -0.0010731385428547039, -0.0010677728501404303, -0.0010624339858897281, -0.0010571218159602794, -0.001051836206880478, -0.0010465770258460756, -0.0010413441407168453, -0.001036137420013261, -0.0010309567329131947, -0.0010258019492486287, -0.0010206729395023856, -0.0010155695748048736, -0.0010104917269308494, -0.001005439268296195, -0.001000412071954714, -0.0009954100115949405, -0.0009904329615369658, -0.000985480796729281, -0.0009805533927456345, -0.0009756506257819063, -0.0009707723726529967, -0.0009659185107897318, -0.0009610889182357831, -0.0009562834736446042, -0.0009515020562763811, -0.0009467445459949992, -0.0009420108232650243, -0.0009373007691486991, -0.0009326142653029556, -0.0009279511939764408, -0.0009233114380065586, -0.0009186948808165258, -0.0009141014064124431, -0.0009095308993803809, -0.000904983244883479, -0.0009004583286590616, -0.0008959560370157663, -0.0008914762568306875, -0.000887018875546534, -0.0008825837811688013, -0.0008781708622629574, -0.0008737800079516426, -0.0008694111079118843, -0.0008650640523723249, -0.0008607387321104633, -0.000856435038449911, -0.0008521528632576614, -0.0008478920989413732, -0.0008436526384466663, -0.0008394343752544329, -0.0008352372033781607, -0.0008310610173612699, -0.0008269057122744635, -0.0008227711837130912, -0.0008186573277945258, -0.0008145640411555532, -0.0008104912209497754, -0.0008064387648450265, -0.0008024065710208014, -0.0007983945381656973, -0.0007944025654748689, -0.0007904305526474946, -0.0007864783998842571, -0.0007825460078848358, -0.0007786332778454115, -0.0007747401114561844, -0.0007708664108989035, -0.0007670120788444089, -0.0007631770184501869, -0.000759361133357936, -0.0007555643276911463, -0.0007517865060526905, -0.000748027573522427, -0.0007442874356548149, -0.0007405659984765408, -0.0007368631684841581, -0.0007331788526417373, -0.0007295129583785286, -0.000725865393586636, -0.0007222360666187028, -0.0007186248862856092, -0.0007150317618541812, -0.0007114566030449103, -0.0007078993200296857, -0.0007043598234295372, -0.0007008380243123895, -0.0006973338341908276, -0.0006938471650198735, -0.0006903779291947741, -0.0006869260395488002, -0.0006834914093510562, -0.000680073952304301, -0.0006766735825427795, -0.0006732902146300656, -0.0006699237635569152, -0.0006665741447391306, -0.000663241274015435, -0.0006599250676453577, -0.000656625442307131, -0.0006533423150955953, -0.0006500756035201174, -0.0006468252255025168, -0.0006435910993750042, -0.0006403731438781292, -0.0006371712781587385, -0.0006339854217679448, -0.0006308154946591051, -0.0006276614171858095, -0.0006245231100998805, -0.0006214004945493811, -0.0006182934920766342, -0.000615202024616251, -0.0006121260144931697, -0.0006090653844207039, -0.0006060200574986004, -0.0006029899572111073, -0.0005999750074250518, -0.0005969751323879265, -0.0005939902567259869, -0.000591020305442357, -0.0005880652039151452, -0.0005851248778955695, -0.0005821992535060917, -0.0005792882572385612, -0.0005763918159523685, -0.0005735098568726067, -0.0005706423075882436, -0.0005677890960503024, -0.0005649501505700509, -0.0005621253998172006, -0.0005593147728181146, -0.000556518198954024, -0.0005537356079592539, -0.0005509669299194576, -0.0005482120952698603, -0.000545471034793511, -0.0005427436796195434, -0.0005400299612214457, -0.0005373298114153385, -0.0005346431623582618, -0.0005319699465464705, -0.0005293100968137382, -0.0005266635463296695, -0.0005240302285980211, -0.000521410077455031, -0.0005188030270677559, -0.0005162090119324171, -0.000513627966872755, -0.0005110598270383912, -0.0005085045279031992, -0.0005059620052636833, -0.0005034321952373648, -0.000500915034261178, -0.000498410459089872, -0.0004959184067944227, -0.0004934388147604506, -0.0004909716206866483, -0.000488516762583215, -0.00048607417877029893, -0.00048364380787644745, -0.0004812255888370652, -0.00047881946089287986, -0.00047642536358841544, -0.00047404323677047335, -0.000471673020586621, -0.00046931465548368786, -0.0004669680822062694, -0.00046463324179523807, -0.00046231007558626187, -0.0004599985252083306, -0.0004576985325822889, -0.00045541003991937743, -0.00045313298971978055, -0.00045086732477118166, -0.00044861298814732577, -0.00044636992320658915, -0.0004441380735905562, -0.0004419173832226034, -0.0004397077963064904, -0.00043750925732495793, -0.00043532171103833315, -0.0004331451024831415, -0.0004309793769707258, -0.00042882448008587217, -0.0004266803576854428, -0.0004245469558970156, -0.0004224242211175305, -0.00042031210001194284, -0.0004182105395118831, -0.00041611948681432367, -0.00041403888938025204]


#####################################################
# Tests
#####################################################
def test_dc_blocker():
    """ Test DC Blocker algorithm """
    dcb_test = DcBlocker()
    dcb_test.reset()
    test_dc_blocker_out = dcb_test.process(imp)
    assert test_dc_blocker_out == test_dc_blocker_out_expected_output
